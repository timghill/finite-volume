
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.6">
    
    
      
        <title>Shallow water equations - Finite volume methods</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6910b76c.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.196e0c26.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#shallow-water-equations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="Finite volume methods" class="md-header-nav__button md-logo" aria-label="Finite volume methods">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2L1 21h22M12 6l7.53 13H4.47"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Finite volume methods
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Shallow water equations
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Finite volume methods" class="md-nav__button md-logo" aria-label="Finite volume methods">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2L1 21h22M12 6l7.53 13H4.47"/></svg>

    </a>
    Finite volume methods
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Shallow water equations
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Shallow water equations
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#two-dimensional-shallow-water-equations" class="md-nav__link">
    Two-dimensional shallow water equations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finite-volume-methods" class="md-nav__link">
    Finite volume methods
  </a>
  
    <nav class="md-nav" aria-label="Finite volume methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#numerical-flux-function" class="md-nav__link">
    Numerical flux function
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#boundary-conditions" class="md-nav__link">
    Boundary conditions
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../heat_equation/" class="md-nav__link">
      Heat equation
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#two-dimensional-shallow-water-equations" class="md-nav__link">
    Two-dimensional shallow water equations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finite-volume-methods" class="md-nav__link">
    Finite volume methods
  </a>
  
    <nav class="md-nav" aria-label="Finite volume methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#numerical-flux-function" class="md-nav__link">
    Numerical flux function
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#boundary-conditions" class="md-nav__link">
    Boundary conditions
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="shallow-water-equations">Shallow water equations</h1>
<p>Our finite volume methods were originally developed for the shallow water equations. In a few senses this was an odd choice:</p>
<ul>
<li>Our eventual model has a scalar state variable.</li>
<li>Our model is diffusive, so we do not need to add numerical diffusion.</li>
</ul>
<p>Nevertheless, they are a good test for our methods and provide a good case study.</p>
<h2 id="two-dimensional-shallow-water-equations">Two-dimensional shallow water equations</h2>
<p>The shallow water solver solves the two-dimensional system of equations</p>
<p>$$\frac{\partial}{\partial t} \begin{bmatrix} h \\ hu \\ hv \end{bmatrix} + \frac{\partial}{\partial x} \begin{bmatrix} hu \\ hu^2 + \frac{1}{2}gh^2 \\ huv \end{bmatrix} + \frac{\partial}{\partial y} \begin{bmatrix} hv \\ huv \\ hv^2 + \frac{1}{2}gh^2 \end{bmatrix} = 0$$</p>
<p>We note that the conserved quantities in these equations are not the physical variables \((h, u, v)\), but are the depth and momenta \(\vec{u} = (h, m_x, m_y)\), where \(m-x = hu\) and \(m_y = hv\). In terms of these conserved quantities, the equations become</p>
<p>$$\frac{\partial}{\partial t} \begin{bmatrix} h \\ m_x \\ m_y \end{bmatrix} + \frac{\partial}{\partial x} \begin{bmatrix} m_x \\ \frac{m_x^2}{h} + \frac{1}{2}gh^2 \\ \frac{m_x m_y}{h} \end{bmatrix} + \frac{\partial}{\partial y} \begin{bmatrix} m_y \\ \frac{m_x m_y}{h} \\ \frac{m_y^2}{h} + \frac{1}{2}gh^2 \end{bmatrix} = 0$$</p>
<p>We also note the symmetry between \(x\) and \(y\). We recognize the \(\frac{\partial}{\partial x}\) term as representing the flux in the \(x\)-direction, and the \(\frac{\partial}{\partial y}\) term as representing the flux in the \(y\)-direction (for example by integrating over a square). To apply finite volume methods, we therefore need to write the flux generally for normal and tangent momentum components.</p>
<p>Let \(m_n\) by the normal component of momentum, and \(m_\tau\) be the tangent component with respect to a a cell boundary. Then, we have that the flux is</p>
<p>$$ \vec{f}(\vec{u}) = \begin{bmatrix} f_h \\ f_n \\ f_\tau \end{bmatrix} = \begin{bmatrix} m_n \\ \frac{m_x^n}{h} + \frac{1}{2}gh^2 \\ \frac{m_n m_\tau}{h} \end{bmatrix}$$</p>
<p>Note that the first component says that convergence of the normal component of momentum causes an increase in water depth. This is exactly what we want! Now, we can write the system of equations as</p>
<p>$$\frac{\partial \vec{u}}{\partial t} + \frac{\partial}{\partial n} \vec{f}(\vec{u}) + \frac{\partial}{\partial \tau} \vec{f}(\vec{u}) = 0$$</p>
<p>where $\vec{n} and \vec{\tau}$ are the normal and tangent vectors.</p>
<h2 id="finite-volume-methods">Finite volume methods</h2>
<p>As usual, we integrate over a control volume \(\Omega\). However, we note that only the normal component of flux will act to exchange mass across an edge. We also note that we will replace the flux \(\vec{f}\) with the <em>numerical</em> flux \(\vec{f}^*(\vec{u}_1, \vec{u}_2)\), which depends on the state vector on both sides of the boundary. Therefore, we end up with</p>
<p>$$\frac{\partial \vec{u}_i}{\partial t} + \frac{1}{|\Omega_i|} \sum_j \vec{f}^*(\vec{u}_i, \vec{u}_j)l_j = 0$$</p>
<p>where \(\vec{u}_i\) is the <em>average</em> of \(\vec{u}\) on element \(\Omega_i\), \(|\Omega_i|\) is the area of the element, and \(l_j\) is the length of edge \(\Gamma_j\).</p>
<h3 id="numerical-flux-function">Numerical flux function</h3>
<p>We use a simple first-order numerical flux function, where we take the average of values on neighbouring elements. We add the minimum diffusion required for stability. This turns out to be</p>
<p>$$\vec{f}^*(\vec{u}_1, \vec{u}_2) = \frac{1}{2}[\vec{f}(\vec{u}_1) + \vec{f}(\vec{u}_2)] - \frac{\alpha}{2}(\vec{u}_2 - \vec{u}_1)$$
where \(\alpha = \frac{|m_n|}{h} + \sqrt{h}\) (which can be calculated from the eigenvalues of the flux Jacobian).</p>
<h2 id="boundary-conditions">Boundary conditions</h2>
<p>We apply ideal wall boundary conditions. That is, we implement ghost cells where we reverse the momentum components</p>
<p>$$\vec{u}_j = \begin{bmatrix} h \\ -m_{n,i} \\ -m_{\tau,i} \end{bmatrix}$$</p>
<p>This ensures no mass crosses the boundary.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href=".." class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </div>
            </div>
          </a>
        
        
          <a href="../heat_equation/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Heat equation
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.fd16492e.min.js"></script>
      <script src="../assets/javascripts/bundle.7836ba4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="../javascripts/extra.js"></script>
      
    
  </body>
</html>